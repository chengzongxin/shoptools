# Temu API 测试脚本

这是一个用于测试 Temu 代理商产品查询接口的 Python 爬虫脚本。

## 🎯 项目目的

- 测试 Temu 代理商平台的 SKC 产品查询接口
- 学习 Python 网络请求和 API 测试技术
- 了解反爬虫机制和请求头设置

## 📋 功能特性

- ✅ 完整的请求头设置（包含反爬虫标识）
- ✅ 自动连接测试
- ✅ 多页数据查询
- ✅ 详细的响应数据分析
- ✅ 完整的日志记录
- ✅ 错误处理和异常捕获
- ✅ 请求频率控制

## 🛠️ 安装依赖

### 1. 确保已安装 Python 3.7+

```bash
python3 --version
```

### 2. 安装依赖包

```bash
pip3 install -r requirements.txt
```

或者手动安装：

```bash
pip3 install requests typing-extensions
```

## 🚀 使用方法

### 基本使用

```bash
python3 temu_api_test.py
```

### 自定义测试

你可以修改脚本中的参数来定制测试：

```python
# 在 main() 函数中修改
tester.run_test(pages=5)  # 测试5页数据
```

## 📊 输出说明

### 控制台输出
脚本会在控制台显示详细的测试过程，包括：
- 🔄 请求状态
- 📊 响应信息
- ✅ 成功标识
- ❌ 错误信息
- 📦 产品数据

### 日志文件
所有详细信息会保存到 `temu_api_test.log` 文件中，包括：
- 时间戳
- 请求详情
- 响应数据
- 错误信息

## 🔧 代码结构说明

### 主要类和函数

1. **TemuAPITester 类**
   - `__init__()`: 初始化测试器，设置请求头
   - `test_api_connection()`: 测试API连接
   - `query_products()`: 查询产品数据
   - `analyze_response()`: 分析响应数据
   - `run_test()`: 运行完整测试流程

2. **请求头设置**
   - 包含完整的浏览器请求头
   - 反爬虫标识 (`anti-content`)
   - 认证信息 (`cookie`, `AccessToken`)
   - 用户代理和其他安全头部

3. **错误处理**
   - 网络连接异常
   - 请求超时
   - JSON 解析错误
   - HTTP 状态码检查

## ⚠️ 重要注意事项

### 1. 请求头更新
- `anti-content` 字段可能会过期，需要定期更新
- `cookie` 中的认证信息可能会失效
- 建议定期从浏览器中复制最新的请求头

### 2. 请求频率
- 脚本已设置2秒延迟，避免请求过于频繁
- 可以根据需要调整延迟时间
- 过于频繁的请求可能触发反爬虫机制

### 3. 数据使用
- 请遵守 Temu 的使用条款
- 仅用于学习和测试目的
- 不要用于商业用途

## 🔍 常见问题

### Q: 请求返回 403 错误怎么办？
A: 可能是 `anti-content` 或 `cookie` 已过期，需要从浏览器中重新获取。

### Q: 如何获取最新的请求头？
A: 
1. 打开浏览器开发者工具 (F12)
2. 切换到 Network 标签
3. 在 Temu 网站上执行相关操作
4. 找到对应的请求，复制请求头信息

### Q: 脚本运行很慢怎么办？
A: 可以调整 `time.sleep()` 的延迟时间，但要注意不要设置太短。

## 📚 学习要点

### 1. HTTP 请求基础
- GET vs POST 请求
- 请求头和响应头
- 状态码含义
- Cookie 和会话管理

### 2. Python 网络编程
- `requests` 库的使用
- 会话对象 (`Session`)
- 异常处理
- JSON 数据处理

### 3. 反爬虫技术
- 请求头伪装
- 用户代理设置
- 反爬虫标识
- 请求频率控制

### 4. 日志记录
- Python `logging` 模块
- 日志级别设置
- 文件和控制台输出

## 🎓 进一步学习建议

1. **深入学习 requests 库**
   - 代理设置
   - 文件上传下载
   - 自定义认证

2. **了解其他反爬虫技术**
   - IP 代理池
   - 验证码处理
   - 浏览器自动化 (Selenium)

3. **学习数据处理**
   - JSON 数据解析
   - 数据清洗和转换
   - 数据存储 (CSV, 数据库)

4. **掌握异步编程**
   - `aiohttp` 异步请求
   - 并发控制
   - 性能优化

## 📄 许可证

本项目仅用于学习和测试目的，请遵守相关网站的使用条款。 