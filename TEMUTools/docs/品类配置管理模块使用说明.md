# 品类配置管理模块使用说明

## 功能概述

品类配置管理模块提供了一个友好的图形界面，用于集中管理所有商品类别的配置信息。这个模块是整个系统的核心配置中心，影响到实拍图上传、核价管理、竞价管理等多个功能模块。

## 主要功能

### 1. 品类列表管理
- **查看所有品类**：以表格形式展示所有商品类别及其详细信息
- **状态筛选**：可以看到启用和禁用的品类数量统计
- **多选操作**：支持按住 Ctrl/Cmd 键多选品类进行批量操作

### 2. 增删改查功能

#### 新增品类
1. 点击工具栏的 **"➕ 新增品类"** 按钮
2. 在弹出的对话框中填写以下信息：
   - **品类名称**：商品类别的中文名称（必填）
   - **类别ID**：TEMU系统中的类别ID（必填，数字）
   - **实拍图文件**：对应的实拍图片文件名（必填，可通过"选择文件"按钮选择）
   - **价格底线**：该类别商品的最低价格限制（必填，数字）
   - **商品码**：用于生成商品编码的前缀映射（必填）
   - **启用状态**：勾选表示启用该品类
3. 点击 **"保存"** 完成添加

#### 编辑品类
- 方式1：选中品类后点击 **"✏️ 编辑品类"** 按钮
- 方式2：直接双击品类行
- 在弹出的对话框中修改信息后保存
- **注意**：类别ID在编辑时不可修改，以保证数据一致性

#### 删除品类
1. 选中一个或多个要删除的品类（支持多选）
2. 点击 **"🗑️ 删除品类"** 按钮
3. 确认删除操作
4. **警告**：删除操作不可恢复，请谨慎操作

### 3. 启用/禁用功能

#### 启用品类
1. 选中要启用的品类（支持多选）
2. 点击 **"✅ 启用选中"** 按钮
3. 已启用的品类会在各个功能模块中正常显示和使用

#### 禁用品类
1. 选中要禁用的品类（支持多选）
2. 点击 **"❌ 禁用选中"** 按钮
3. 已禁用的品类会：
   - 在品类列表中显示为灰色
   - 在实拍图上传功能中不会显示
   - 不参与核价、竞价等业务流程

### 4. 图片管理功能

#### 打开图片目录
- 点击 **"📁 打开图片目录"** 按钮
- 系统会自动打开 `assets/images` 目录
- 您可以在该目录中：
  - 添加新的实拍图文件
  - 查看现有图片
  - 删除不需要的图片

#### 选择和上传图片
在编辑/新增品类对话框中：
1. 点击 **"选择文件"** 按钮
2. 选择图片文件（支持 jpg、jpeg、png、gif、bmp 格式）
3. 如果选择的图片不在图片目录中，系统会询问是否自动复制
4. 图片选择后会在对话框底部显示预览

## 字段说明

| 字段名称 | 说明 | 类型 | 必填 | 备注 |
|---------|------|------|------|------|
| 品类名称 | 商品类别的中文名称 | 文本 | ✅ | 用于界面显示 |
| 类别ID | TEMU系统中的类别ID | 数字 | ✅ | 必须是唯一的，编辑时不可修改 |
| 实拍图文件 | 对应的实拍图片文件名 | 文本 | ✅ | 文件必须存在于 assets/images 目录 |
| 价格底线 | 该类别商品的最低价格 | 数字 | ✅ | 单位：元，用于核价和竞价时的价格判断 |
| 商品码 | 商品编码前缀映射 | 文本 | ✅ | 用于生成商品码模板 |
| 启用状态 | 是否启用该品类 | 布尔 | ✅ | 禁用的品类不会在功能模块中显示 |

## 配置文件

品类配置保存在 `src/config/category_config.json` 文件中，格式如下：

```json
{
  "categories": [
    {
      "name": "抽绳健身包",
      "cate_id": 31563,
      "image_file": "帆布袋、束口袋.jpg",
      "price_threshold": 12.7,
      "code_mapping": "CB-0608",
      "enabled": true
    }
  ],
  "last_update": "2025-10-09 14:30:00"
}
```

## 影响范围

修改品类配置会影响以下功能模块：

1. **实拍图上传模块**
   - 只显示已启用的品类供选择
   - 使用配置的图片文件进行上传

2. **核价管理模块**
   - 使用价格底线进行价格审核判断
   - 低于价格底线的会触发拒绝或重新议价

3. **竞价管理模块**
   - 使用价格底线进行竞价判断
   - 竞价价格不会低于设定的价格底线

4. **商品列表模块**
   - 使用商品码映射生成商品编码模板

## 快捷操作

- **双击品类行**：快速编辑该品类
- **Ctrl/Cmd + 点击**：多选品类
- **Shift + 点击**：连续选择多个品类
- **F5**：刷新品类列表（使用"刷新列表"按钮）

## 注意事项

1. **类别ID唯一性**
   - 每个品类的类别ID必须是唯一的
   - 新增时如果ID已存在会导致配置混乱
   - 编辑时不允许修改类别ID

2. **图片文件管理**
   - 图片文件必须存在于 `assets/images` 目录
   - 删除品类不会自动删除对应的图片文件
   - 建议定期清理不再使用的图片文件

3. **禁用vs删除**
   - 如果暂时不需要某个品类，建议使用"禁用"而不是"删除"
   - 禁用的品类可以随时重新启用
   - 删除操作不可恢复

4. **配置同步**
   - 修改配置后会自动保存并刷新缓存
   - 其他功能模块会立即使用最新的配置
   - 如果有正在运行的任务，可能需要重启任务才能生效

5. **批量操作**
   - 批量启用/禁用时请仔细确认选择的品类
   - 批量删除时系统会提示确认，请谨慎操作

## 最佳实践

1. **新增品类流程**
   ```
   准备图片 → 放入assets/images目录 → 新增品类 → 填写完整信息 → 保存
   ```

2. **修改价格底线**
   ```
   打开品类配置 → 找到对应品类 → 双击编辑 → 修改价格底线 → 保存
   ```

3. **季节性品类管理**
   ```
   非销售季：禁用品类
   销售季：启用品类
   完全不再销售：删除品类
   ```

4. **图片命名建议**
   - 使用有意义的中文名称
   - 多个品类可以共用同一张图片
   - 建议图片大小在 500KB 以内，分辨率 800x800 左右

## 故障排除

### 问题1：图片无法显示预览
**可能原因**：图片文件不存在或格式不支持
**解决方法**：
1. 确认图片文件在 `assets/images` 目录中
2. 确认图片格式为 jpg、jpeg、png、gif 或 bmp
3. 尝试使用其他图片

### 问题2：保存后配置没有生效
**可能原因**：缓存未刷新
**解决方法**：
1. 点击"刷新列表"按钮
2. 如果其他模块没有生效，尝试重启应用程序

### 问题3：类别ID冲突
**可能原因**：手动编辑配置文件导致ID重复
**解决方法**：
1. 在品类列表中查找重复的ID
2. 修改其中一个品类的ID
3. 或者删除重复的品类

### 问题4：图片目录打不开
**可能原因**：目录不存在或权限不足
**解决方法**：
1. 系统会询问是否创建目录，选择"是"
2. 如果仍无法打开，手动创建 `assets/images` 目录
3. 检查目录权限

## 更新日志

### v1.0 (2025-10-09)
- ✅ 初始版本发布
- ✅ 实现品类的增删改查功能
- ✅ 实现启用/禁用功能
- ✅ 实现图片选择和预览功能
- ✅ 集成到主程序

## 技术支持

如有问题或建议，请联系技术支持团队。

